# Lefthook Configuration for qfm

pre-commit:
  parallel: true
  commands:
    golangci-lint:
      glob: "*.go"
      run: golangci-lint run --fix
      stage_fixed: true

    go-test:
      run: go test -short ./...

  skip:
    - merge
    - rebase

pre-push:
  commands:
    go-test:
      run: go test -v -race ./...

    go-build:
      run: go build ./...

commit-msg:
  commands:
    conventional-commit:
      run: |
        MSG=$(cat {1})
        if ! echo "$MSG" | grep -qE "^(feat|fix|docs|style|refactor|perf|test|chore|ci|build)(\([a-zA-Z0-9_-]+\))?: .+$"; then
          echo "ERROR: Commit message must follow Conventional Commits format:"
          echo "  type(scope?): subject"
          echo ""
          echo "Valid types: feat, fix, docs, style, refactor, perf, test, chore, ci, build"
          exit 1
        fi
